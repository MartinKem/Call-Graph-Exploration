<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <script src="https://d3js.org/d3.v3.min.js"></script>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

    <link href="resources/CSS/style.css" rel="stylesheet" type="text/css">
    <title>D3 Graph</title>
</head>
<body>
	<div id="load_page">
		<!--Filereader fÃ¼r JSON Datei-->
		<form id="jsonFile" name="jsonFile" enctype="multipart/form-data" method="post">
			<fieldset>
				<h2>Json File</h2>
			  	<div id="dropZone">You can Drop files here <br />
				<input type='file' id='fileinput' onchange="setProgBarToZero(); loadFile()">
			  	</div> <br />

			  	<div id="progress_bar">
					<div id="progress" class="percent">0%</div>
			  	</div> <br/>
			</fieldset>
		  </form>
	</div>

	<div id="graph_page" class="invis">
		<div id='graph' style="position: relative; font-family: Helvetica"></div>
		<div id="top_fixed" style="position: fixed; top: 10px; left: 10px">
			<form autocomplete="off" onsubmit="return false" style="overflow: auto;">
				<div class="autocomplete" style="float: left; margin-right: 10px">
				<input type="text" name="searchClass" id="classInput" placeholder="Class-Path">
				</div>
				<div class="autocomplete" style="float: left; margin-right: 10px">
				<input type="text" name="searchMethod" id="methodInput" placeholder="Method">
				</div>
				<input type="submit" id="search" disabled value="Find" onclick="callSearch(); createGraph()">
			</form>
			<button id="btn" onclick="open_close()" style="margin-top: 10px">Hide Details</button>
		</div>
	</div>

	<script>
		let f = d3.layout.force;
		
		var createdNodes = 0;
		var svgCont = d3.select("#graph")
			.append("svg")
			.attr("width", 40000)
			.attr("height", 40000);
			
		var defsCont = svgCont.append("defs").attr("id", "definitions");
		
		var rootNodeString;
		var rootNode;	// initialized in jsonPars.js and referenced in node.js
		var rootNodes = [];
		
		var nodeMap = new Map();


	</script>
	<script>
		var i = 0;
		function open_close() {

			if (i===0){
				d3.selectAll(".node_inhalt").classed("invis",true);
				rootNodes.forEach(allToAbstract);
				document.getElementById("btn").innerText = "Show details";
				i++;
			}else {

				d3.selectAll(".node_inhalt").classed("invis",false);
				rootNodes.forEach(allToDetailed);
				document.getElementById("btn").innerText = "Hide details";
				i=0;
			}
			return;
		}
	</script>
	<script src="resources/JavaScript/contextmenu.js"></script>
	<script src="resources/JavaScript/jsonPars.js"></script>
	<script src="resources/JavaScript/search.js"></script>
	<script src="resources/JavaScript/forceTree.js"></script>
    <script src="resources/JavaScript/edges.js"></script>
    <script src="resources/JavaScript/nodes.js"></script>
</body>
</html>